name: naga-validation-linux

on:
  push:
    branches: ["*"]
    tags: [v0.*]
  pull_request:
  merge_group:

jobs:
  validate-linux:
    name: Validate Naga SPIR-V + GLSL Output
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3

      - name: Install tools
        run: sudo apt-get install spirv-tools glslang-tools graphviz

      - uses: Swatinem/rust-cache@v2
        with:
          workspaces: |
            naga/xtask -> naga/xtask/target

      - run: cargo xtask validate spv

      - run: cargo xtask validate glsl

      - run: cargo xtask validate dot

      - run: cargo xtask validate wgsl
